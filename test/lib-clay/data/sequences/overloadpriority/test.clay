import test.*;

record MySequenceForPrecedence (
    i: Int,
);
    
record MyIteratorForPrecedence();

override iterator(seq: MySequenceForPrecedence) = MyIteratorForPrecedence();

override nextValue(iter: MyIteratorForPrecedence) = nothing(Int);

testSequenceEqualsHigherThatRecordPrecedence() {
    // if 'equal?' from records has higher precedence, this test fails
    expectEqual(MySequenceForPrecedence(1), MySequenceForPrecedence(2));
}

main() = testMain(
    TestSuite(
        "sequence equality override priority", array(
            TestCase("sequence type uses sequence equals? specialization",
                testSequenceEqualsHigherThatRecordPrecedence))));
