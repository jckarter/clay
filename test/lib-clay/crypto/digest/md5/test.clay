import 
    crypto.digest.md5.*,
    printer.(str),
    printer.formatter.(repr),
    test.*,
    test.module.*;

forceinline expectDigest(algorithm, hash, string) {
    expectPrinted(hash, digest(string, algorithm));
}

forceinline expectMd5(hash, string) {
    expectDigest(MD5_NAME, hash, string);
}

TEST_md5() {
    expectMd5(
        "d41d8cd98f00b204e9800998ecf8427e",
        "");
    expectMd5(
        "15b29ffdce66e10527a65bc6d71ad94d",
        "swordfish");
    expectMd5(
        "c4ca4238a0b923820dcc509a6f75849b",
        "1");
    expectMd5(
        "25d55ad283aa400af464c76d713c07ad",
        "12345678");
    expectMd5(
        "d92fe77e057d3fc33deca67c86bc2b97",
        "123456789101112131415");
    expectMd5(
        "2f123b3fb38dcaa66047eac9b154f447",
        "12345678910111213141516171819202122");
    expectMd5(
        "41a1b3542eb5504b46a36fefd46ab02e",
        "1234567891011121314151617181920212223242526272829");
    expectMd5(
        "4f4212cf099b5d6641f77d41ae03b14a",
        "123456789101112131415161718192021222324252627282930313233343536");
    expectMd5(
        "768d5e514733786fa09f6d484d0e7103",
        "12345678910111213141516171819202122232425262728293031323334353637383940414243");
    expectMd5(
        "7e6c29eb666e63d95ecc3e15adce81d5",
        "1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950");
    expectMd5(
        "16c1818a59b366f52409183f6190e8d1",
        "123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657");
    expectMd5(
        "a0932637810fee3f2c567fa194c73fbb",
        "12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364");
    expectMd5(
        "871d7591c769a6ec454d08e3fc7dd276",
        "1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071");
    expectMd5(
        "baefd50e775abe63dc7eb16d1764e3ab",
        "123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778");
    expectMd5(
        "6262755fa1e44d947a6b929410a96d4a",
        "12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485");
}

private main() = testMainModule();
