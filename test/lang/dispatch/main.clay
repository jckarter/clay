import __operators__;
import printer.(errorNoThrow, println);

record LessThanThree (index:Int);

__operators__.DispatchTagCount(#LessThanThree) = 3;
__operators__.dispatchTag(x:LessThanThree) = x.index;
[n]
__operators__.dispatchIndex(x:LessThanThree, #n) = #n;

__operators__.invalidDispatch(x:LessThanThree) {
    errorNoThrow("invalid LessThanThree, tag = ", x.index);
}

define foo;
foo(#0) = StringLiteralRef("zero");
foo(#1) = StringLiteralRef("one");
foo(#2) = StringLiteralRef("two");

main() {
    var x, y, z = LessThanThree(0), LessThanThree(1), LessThanThree(2);
    println(foo(*x));
    println(foo(*y));
    println(foo(*z));
}
