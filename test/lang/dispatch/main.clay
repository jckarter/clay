import __operators__;
import printer.(errorNoThrow, println);

record LessThanThree (index:Int);

override __operators__.DispatchTagCount(#LessThanThree) = 3;
override __operators__.dispatchTag(x:LessThanThree) = x.index;
[n]
override __operators__.dispatchIndex(x:LessThanThree, #n) = #n;

override __operators__.invalidDispatch(x:LessThanThree) {
    errorNoThrow("invalid LessThanThree, tag = ", x.index);
}

define foo;
override foo(#0) = StringLiteralRef("zero");
override foo(#1) = StringLiteralRef("one");
override foo(#2) = StringLiteralRef("two");

main() {
    var x, y, z = LessThanThree(0), LessThanThree(1), LessThanThree(2);
    println(foo(*x));
    println(foo(*y));
    println(foo(*z));
}
